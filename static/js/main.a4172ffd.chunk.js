(this["webpackJsonpsupabase-react-chat-app"]=this["webpackJsonpsupabase-react-chat-app"]||[]).push([[0],{222:function(e,t,n){},223:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),a=n(24),i=n.n(a),c=n(26),o=n(234),u=n(131),l=Object(u.a)("https://wjrccfiirpuqxuddcxyt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyNjg1MTEzOCwiZXhwIjoxOTQyNDI3MTM4fQ.FMduX0kJ2ddY2XhwPeRa9mXWSLhO87UWa5dqGFzFm4I",{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}),d=n(6),j=n.n(d),b=n(84),m=function(){return{signUp:function(e,t){return l.auth.signUp({email:e,password:t})},signIn:function(e,t){return l.auth.signIn({email:e,password:t})},getSession:function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.auth.session(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}},p=n(233),O=n(231),h=n(232),f=n(51),g=n(236),x=n(8),y=function(e){var t=e.isModalOpen,n=void 0!==t&&t,s=e.onClose,a=Object(r.useState)(""),i=Object(c.a)(a,2),o=i[0],u=i[1],d=Object(r.useState)(!1),j=Object(c.a)(d,2),b=j[0],m=j[1];return Object(x.jsx)(p.a,{title:"Login",visible:n,onCancel:s,okButtonProps:{style:{display:"none"}},cancelButtonProps:{style:{display:"none"}},centered:!0,children:Object(x.jsxs)(O.a,{layout:"vertical",initialValues:{email:"",password:""},wrapperCol:{style:{textAlign:"center"}},onFinish:function(e){var t=e.email,n=e.password;l.auth.signIn({email:t,password:n}).then((function(e){m(!1),!e.error&&e.user?s():e.error&&u(e.error.message)})).catch((function(e){u(e),m(!1)}))},children:[Object(x.jsx)(O.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}],children:Object(x.jsx)(h.a,{onFocus:function(){return u("")}})}),Object(x.jsx)(O.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(x.jsx)(h.a.Password,{onFocus:function(){return u("")}})}),Object(x.jsx)(O.a.Item,{children:Object(x.jsx)(f.a,{type:"primary",htmlType:"submit",loading:b,children:"Login"})}),o&&Object(x.jsx)(g.a,{message:o,type:"error"})]})})},v=function(e){var t=e.isModalOpen,n=void 0!==t&&t,s=e.onClose,a=Object(r.useState)(""),i=Object(c.a)(a,2),o=i[0],u=i[1],d=Object(r.useState)(!1),j=Object(c.a)(d,2),b=j[0],m=j[1];return Object(x.jsx)(p.a,{title:"Login",visible:n,onCancel:s,okButtonProps:{style:{display:"none"}},cancelButtonProps:{style:{display:"none"}},centered:!0,children:Object(x.jsxs)(O.a,{layout:"vertical",initialValues:{email:"",password:""},wrapperCol:{style:{textAlign:"center"}},onFinish:function(e){var t=e.email,n=e.password;m(!0),l.auth.signUp({email:t,password:n}).then((function(e){m(!1),!e.error&&e.user?s():e.error&&u(e.error.message)})).catch((function(e){u(e),m(!1)}))},children:[Object(x.jsx)(O.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}],children:Object(x.jsx)(h.a,{onFocus:function(){return u("")}})}),Object(x.jsx)(O.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(x.jsx)(h.a.Password,{onFocus:function(){return u("")}})}),Object(x.jsx)(O.a.Item,{children:Object(x.jsx)(f.a,{type:"primary",htmlType:"submit",loading:b,children:"Login"})}),o&&Object(x.jsx)(g.a,{message:o,type:"error"})]})})},w=o.a.Header,I=function(e){var t=e.user,n=Object(r.useState)(!1),a=Object(c.a)(n,2),i=a[0],o=a[1],u=Object(r.useState)(!1),d=Object(c.a)(u,2),j=d[0],b=d[1];return Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)(y,{isModalOpen:i,onClose:function(){return o(!1)}}),Object(x.jsx)(v,{isModalOpen:j,onClose:function(){return b(!1)}}),Object(x.jsx)(w,{style:{display:"flex",flexDirection:"row",justifyContent:"end"},children:Object(x.jsx)("div",{style:{display:"flex"},children:t?Object(x.jsxs)("div",{style:{color:"white",fontSize:"1rem",cursor:"pointer"},onClick:function(){return l.auth.signOut()},children:["(",t.email,") - Logout"]}):Object(x.jsxs)(s.a.Fragment,{children:[Object(x.jsx)("div",{style:{color:"white",fontSize:"1rem",cursor:"pointer"},onClick:function(){return o(!0)},children:"Login"}),Object(x.jsx)("div",{style:{color:"white",fontSize:".9rem",padding:"0 1em"},children:"or"}),Object(x.jsx)("div",{style:{color:"white",fontSize:"1rem",cursor:"pointer"},onClick:function(){return b(!0)},children:"Sign Up"})]})})})]})},S=n(139),C=n(228),F=n(229),P=n(230),L=n(101),M=n(235),k=function(){var e=Object(r.useState)([]),t=Object(c.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(2),i=Object(c.a)(a,2),o=i[0],u=i[1],d=Object(r.useState)(!1),m=Object(c.a)(d,2),p=m[0],O=m[1];Object(r.useEffect)((function(){l.from("messages").on("INSERT",h).subscribe()}),[n]),Object(r.useEffect)((function(){O(!0),l.from("messages").select().order("created_at",{ascending:!1}).limit(o).then((function(e){O(!1),!e.error&&e.data&&(e.data.reverse(),s(e.data))}))}),[o]);var h=function(e){s([].concat(Object(L.a)(n),[e.new]))};return{loading:p,messages:n,addNewMessage:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,s,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.from("messages").insert([{id:Object(M.a)(),user_id:t,message:n}]);case 2:return r=e.sent,s=r.data,a=r.error,e.abrupt("return",{data:s,error:a});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),increaseLimit:function(){u(o+5)}}},E=function(e){var t=e.user,n=k(),s=n.messages,a=n.addNewMessage,i=n.increaseLimit,c=n.loading,o=Object(r.useRef)();return Object(x.jsx)(C.a,{justify:"center",align:"middle",children:Object(x.jsxs)(F.a,{xs:22,sm:20,md:16,children:[Object(x.jsx)(P.b,{loading:c,itemLayout:"horizontal",dataSource:s,style:{height:"80vh",display:"flex",flexDirection:"column-reverse"},renderItem:function(e,n){return Object(x.jsxs)(x.Fragment,{children:[0===n&&Object(x.jsx)(P.b.Item,{style:{placeContent:"center"},children:Object(x.jsx)(f.a,{onClick:i,children:"Load More"})}),Object(x.jsx)(P.b.Item,{children:Object(x.jsx)(P.b.Item.Meta,{title:e.message,description:"".concat(new Date(e.created_at).toLocaleDateString(),", ").concat(new Date(e.created_at).toLocaleTimeString()),style:e.user_id===(null===t||void 0===t?void 0:t.id)?{textAlign:"end"}:{}})})]})}}),Object(x.jsxs)(O.a,{ref:function(e){return o.current=e},layout:"vertical",initialValues:{email:"",password:""},wrapperCol:{style:{textAlign:"center"}},style:{display:"flex"},onFinish:function(e){var n=e.message;(null===t||void 0===t?void 0:t.id)?(o.current.resetFields(),a(t.id,n)):n?S.b.error("Please Login / Sign Up",2.5):S.b.error("Enter Message",2.5)},children:[Object(x.jsx)(O.a.Item,{name:"message",style:{width:"100%",margin:"0em 1em"},children:Object(x.jsx)(h.a,{placeholder:"Your Message"})}),Object(x.jsx)(O.a.Item,{name:"message",children:Object(x.jsx)(f.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})]})})},T=o.a.Content,D=function(){var e=Object(r.useState)(null),t=Object(c.a)(e,2),n=t[0],s=t[1],a=m().getSession;return Object(r.useEffect)((function(){l.auth.onAuthStateChange((function(e,t){switch(e){case"SIGNED_IN":(null===t||void 0===t?void 0:t.user)&&s(t.user);break;case"SIGNED_OUT":s(null);break;case"USER_UPDATED":(null===t||void 0===t?void 0:t.user)&&s(t.user)}}))}),[]),Object(r.useEffect)((function(){a().then((function(e){s(e?e.user:null)}))}),[]),Object(x.jsxs)(o.a,{style:{minHeight:"100vh"},children:[Object(x.jsx)(I,{user:n}),Object(x.jsx)(T,{children:Object(x.jsx)(E,{user:n})})]})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,237)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),s(e),a(e),i(e)}))};n(222);i.a.render(Object(x.jsx)(s.a.StrictMode,{children:Object(x.jsx)(D,{})}),document.getElementById("root")),U()}},[[223,1,2]]]);
//# sourceMappingURL=main.a4172ffd.chunk.js.map